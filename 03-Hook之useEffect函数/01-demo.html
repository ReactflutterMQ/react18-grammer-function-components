<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="../react.development.js"></script>
    <script src="../react-dom.development.js"></script>
    <script src="../babel.min.js"></script>
    <script src="../prop-types.js"></script>
</head>
<body>
    <div id="app"></div>
    <script type="text/babel">
        /**
         * Effect Hook可以让你在函数组件中执行副作用操作，副作用
         * 即：DOM操作、获取数据、记录日志等
        */

        let app = document.querySelector('#app');
        let root = ReactDOM.createRoot(app);
        let { useState, useEffect } = React;
        /**
         * Effect Hook可以让你在函数组件中执行副作用操作，副作用
         * 即：DOM操作、获取数据、记录日志等
         * 
         * Effect Hook可以用来代替类组件中的生命周期钩子函数
         * 
         * 异步函数，在浏览器渲染DOM后触发的
         * 
         * 需要注意的点：
         * 1、使用多个Effect实现关注点分离
         * 2、通过跳过Effect进行性能优化
         * 3、Effect中使用了某个响应式数据，一定要进行数组的依赖处理
         * 4、频繁的修改某个响应式数据，可通过回调函数进行改写
         * 5、useEffect()是在渲染被绘制到屏幕之后执行的，是异步的；
         * useLayoutEffect()是在渲染之后但在屏幕更新之前，是同步的
         * 5、大部分情况下我们采用useEffect()，性能更好。但当你的
         * useEffect里面的操作需要处理DOM，并且会改变页面的样式，
         * 就需要用useLayoutEffect，否则可能会出现闪屏问题
        */
        let Welcome = (props) => {
            const [ count, setCount ] = useState(0);
            /* useEffect(() => {
                console.log(count);
            }, []) */  // 当useEffect中有响应式数据，那么在依赖数组中一定要指定这个响应式数据

            /* useEffect(() => {
                console.log(123);
            }, [])  // √ 只有初始化的时候触发，模拟 初始的生命周期钩子 */

            const [ msg, setMsg ] = useState('hello');
            /* useEffect(() => {
                setInterval(() => {
                    setCount(count + 1);
                }, 1000);
            }, [count])  // 会造成定时器的累加，所以需要清理，非常麻烦的 */

            useEffect(() => {
                setInterval(() => {
                    setCount((count) => count + 1);
                }, 1000);
            }, [])

            const handleClick = () => {
                setCount(count + 1);
            }
            return (
                <div>
                    <button onClick={handleClick}>点击</button>
                    <div>hello world, { count }, { msg }</div>
                </div>
            );
        }

        let element = (
            <Welcome />
        )
        root.render(element);
    </script>
</body>
</html>